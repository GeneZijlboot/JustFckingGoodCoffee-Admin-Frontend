"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const k=require("vue"),H=(e,n={})=>new Promise((t,r)=>{if(typeof document>"u")return;const a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");if(i.async=!0,i.src=e,i.defer=n.defer,n.preconnectOrigin){const o=document.createElement("link");o.href=n.preconnectOrigin,o.rel="preconnect",a.appendChild(o)}a.appendChild(i),i.onload=t,i.onerror=r}),f=e=>typeof e=="function",d=e=>e&&typeof e=="object"&&!Array.isArray(e),g=(e,...n)=>{if(!n.length)return e;const t=n.shift();if(!(!d(e)||!d(t))){for(const r in t)d(t[r])?(e[r]||Object.assign(e,{[r]:{}}),g(e[r],t[r])):Object.assign(e,{[r]:t[r]});return g(e,...n)}},u=()=>!(typeof window>"u"||typeof document>"u"),_=(e,n=!0)=>{!u()||process.env.NODE_ENV==="production"||n&&console.warn(`[vue-gtag] ${e}`)},J=(e={})=>(_('Missing "appName" property inside the plugin options.',e.app_name==null),_('Missing "name" property in the route.',e.screen_name==null),e);function K(e="",n=""){const t=e.split("/"),r=n.split("/");return t[0]===""&&n[n.length-1]==="/"&&t.shift(),r.join("/")+t.join("/")}const Q=()=>({bootstrap:!0,onReady:null,onError:null,onBeforeTrack:null,onAfterTrack:null,pageTrackerTemplate:null,customResourceURL:"https://www.googletagmanager.com/gtag/js",customPreconnectOrigin:"https://www.googletagmanager.com",deferScriptLoad:!1,pageTrackerExcludedRoutes:[],pageTrackerEnabled:!0,enabled:!0,disableScriptLoad:!1,pageTrackerScreenviewEnabled:!1,appName:null,pageTrackerUseFullPath:!1,pageTrackerPrependBase:!0,pageTrackerSkipSamePath:!0,globalDataLayerName:"dataLayer",globalObjectName:"gtag",defaultGroupName:"default",includes:null,config:{id:null,params:{send_page_view:!1}}});let S={};const A=(e={})=>{const n=Q();S=g(n,e)},s=()=>S,c=(...e)=>{const{globalObjectName:n}=s();!u()||typeof window[n]>"u"||window[n](...e)},p=(...e)=>{const{config:n,includes:t}=s();if(c("config",n.id,...e),Array.isArray(t))for(const r of t)c("config",r.id,...e)},T=(e,n)=>{u()&&(window[`ga-disable-${e}`]=n)},E=(e=!0)=>{const{config:n,includes:t}=s();if(T(n.id,e),Array.isArray(t))for(const r of t)T(r.id,e)},m=()=>{E(!0)},N=()=>{E(!1)},l=(e,n={})=>{const{includes:t,defaultGroupName:r}=s();n.send_to==null&&Array.isArray(t)&&t.length&&(n.send_to=t.map(a=>a.id).concat(r)),c("event",e,n)};let R;const j=e=>{R=e},w=()=>R,h=e=>{if(!u())return;let n;if(typeof e=="string")n={page_path:e};else if(e.path||e.fullPath){const{pageTrackerUseFullPath:t,pageTrackerPrependBase:r}=s(),a=w(),i=a==null?void 0:a.options.base,o=t?e.fullPath:e.path;n={...e.name&&{page_title:e.name},page_path:r?K(o,i):o}}else n=e;n.page_location==null&&(n.page_location=window.location.href),n.send_page_view==null&&(n.send_page_view=!0),l("page_view",n)},y=e=>{const{appName:n}=s();if(!e)return;let t;typeof e=="string"?t={screen_name:e}:t=e,t.app_name=t.app_name||n,l("screen_view",t)},L=(...e)=>{l("exception",...e)},x=e=>{p("linker",e)},B=e=>{l("timing_complete",e)},D=(...e)=>{c("set",...e)},M=(...e)=>{l("refund",...e)},$=e=>{l("purchase",e)},F=e=>{p({custom_map:e})},X=Object.freeze(Object.defineProperty({__proto__:null,config:p,customMap:F,event:l,exception:L,linker:x,optIn:N,optOut:m,pageview:h,purchase:$,query:c,refund:M,screenview:y,set:D,time:B},Symbol.toStringTag,{value:"Module"})),Y=e=>{e.config.globalProperties.$gtag=X},v=e=>({send_page_view:!1,...e}),G=()=>{const{config:e,includes:n}=s();if(c("config",e.id,v(e.params)),Array.isArray(n))for(const t of n)c("config",t.id,v(t.params))},P=(e={},n={})=>{const{appName:t,pageTrackerTemplate:r,pageTrackerScreenviewEnabled:a,pageTrackerSkipSamePath:i}=s();if(i&&e.path===n.path)return;let o=e;if(f(r)?o=r(e,n):a&&(o=J({app_name:t,screen_name:e.name})),a){y(o);return}h(o)},O=e=>{const{pageTrackerExcludedRoutes:n}=s();return n.includes(e.path)||n.includes(e.name)},U=()=>{const{onBeforeTrack:e,onAfterTrack:n}=s(),t=w();t.isReady().then(()=>{k.nextTick().then(()=>{const{currentRoute:r}=t;G(),!O(r.value)&&P(r.value)}),t.afterEach((r,a)=>{k.nextTick().then(()=>{O(r)||(f(e)&&e(r,a),P(r,a),f(n)&&n(r,a))})})})},Z=()=>{if(!u())return;const{enabled:e,globalObjectName:n,globalDataLayerName:t}=s();return window[n]==null&&(window[t]=window[t]||[],window[n]=(...r)=>{window[t].push(r)}),window[n]("js",new Date),e||m(),window[n]},q=()=>{const{onReady:e,onError:n,globalObjectName:t,globalDataLayerName:r,config:a,customResourceURL:i,customPreconnectOrigin:o,deferScriptLoad:I,pageTrackerEnabled:z,disableScriptLoad:V}=s(),W=!!(z&&w());if(Z(),W?U():G(),!V)return H(`${i}?id=${a.id}&l=${r}`,{preconnectOrigin:o,defer:I}).then(()=>{e&&e(window[t])}).catch(b=>(n&&n(b),b))},C=(e,n,t)=>{Y(e),A(n),j(t),s().bootstrap&&q()};exports.addRoutesTracker=U;exports.bootstrap=q;exports.config=p;exports.customMap=F;exports.default=C;exports.event=l;exports.exception=L;exports.install=C;exports.linker=x;exports.optIn=N;exports.optOut=m;exports.pageview=h;exports.purchase=$;exports.query=c;exports.refund=M;exports.screenview=y;exports.set=D;exports.setOptions=A;exports.setRouter=j;exports.time=B;
