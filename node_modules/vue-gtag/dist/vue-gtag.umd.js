(function(o,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],d):(o=typeof globalThis<"u"?globalThis:o||self,d(o.VueGtag={},o.vue))})(this,function(o,d){"use strict";const z=(e,n={})=>new Promise((t,a)=>{if(typeof document>"u")return;const r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");if(s.async=!0,s.src=e,s.defer=n.defer,n.preconnectOrigin){const c=document.createElement("link");c.href=n.preconnectOrigin,c.rel="preconnect",r.appendChild(c)}r.appendChild(s),s.onload=t,s.onerror=a}),g=e=>typeof e=="function",m=e=>e&&typeof e=="object"&&!Array.isArray(e),w=(e,...n)=>{if(!n.length)return e;const t=n.shift();if(!(!m(e)||!m(t))){for(const a in t)m(t[a])?(e[a]||Object.assign(e,{[a]:{}}),w(e[a],t[a])):Object.assign(e,{[a]:t[a]});return w(e,...n)}},f=()=>!(typeof window>"u"||typeof document>"u"),_=(e,n=!0)=>{!f()||process.env.NODE_ENV==="production"||n&&console.warn(`[vue-gtag] ${e}`)},W=(e={})=>(_('Missing "appName" property inside the plugin options.',e.app_name==null),_('Missing "name" property in the route.',e.screen_name==null),e);function H(e="",n=""){const t=e.split("/"),a=n.split("/");return t[0]===""&&n[n.length-1]==="/"&&t.shift(),a.join("/")+t.join("/")}const J=()=>({bootstrap:!0,onReady:null,onError:null,onBeforeTrack:null,onAfterTrack:null,pageTrackerTemplate:null,customResourceURL:"https://www.googletagmanager.com/gtag/js",customPreconnectOrigin:"https://www.googletagmanager.com",deferScriptLoad:!1,pageTrackerExcludedRoutes:[],pageTrackerEnabled:!0,enabled:!0,disableScriptLoad:!1,pageTrackerScreenviewEnabled:!1,appName:null,pageTrackerUseFullPath:!1,pageTrackerPrependBase:!0,pageTrackerSkipSamePath:!0,globalDataLayerName:"dataLayer",globalObjectName:"gtag",defaultGroupName:"default",includes:null,config:{id:null,params:{send_page_view:!1}}});let T={};const v=(e={})=>{const n=J();T=w(n,e)},i=()=>T,l=(...e)=>{const{globalObjectName:n}=i();!f()||typeof window[n]>"u"||window[n](...e)},p=(...e)=>{const{config:n,includes:t}=i();if(l("config",n.id,...e),Array.isArray(t))for(const a of t)l("config",a.id,...e)},P=(e,n)=>{f()&&(window[`ga-disable-${e}`]=n)},O=(e=!0)=>{const{config:n,includes:t}=i();if(P(n.id,e),Array.isArray(t))for(const a of t)P(a.id,e)},h=()=>{O(!0)},S=()=>{O(!1)},u=(e,n={})=>{const{includes:t,defaultGroupName:a}=i();n.send_to==null&&Array.isArray(t)&&t.length&&(n.send_to=t.map(r=>r.id).concat(a)),l("event",e,n)};let A;const E=e=>{A=e},y=()=>A,b=e=>{if(!f())return;let n;if(typeof e=="string")n={page_path:e};else if(e.path||e.fullPath){const{pageTrackerUseFullPath:t,pageTrackerPrependBase:a}=i(),r=y(),s=r==null?void 0:r.options.base,c=t?e.fullPath:e.path;n={...e.name&&{page_title:e.name},page_path:a?H(c,s):c}}else n=e;n.page_location==null&&(n.page_location=window.location.href),n.send_page_view==null&&(n.send_page_view=!0),u("page_view",n)},k=e=>{const{appName:n}=i();if(!e)return;let t;typeof e=="string"?t={screen_name:e}:t=e,t.app_name=t.app_name||n,u("screen_view",t)},N=(...e)=>{u("exception",...e)},R=e=>{p("linker",e)},j=e=>{u("timing_complete",e)},L=(...e)=>{l("set",...e)},B=(...e)=>{u("refund",...e)},D=e=>{u("purchase",e)},M=e=>{p({custom_map:e})},K=Object.freeze(Object.defineProperty({__proto__:null,config:p,customMap:M,event:u,exception:N,linker:R,optIn:S,optOut:h,pageview:b,purchase:D,query:l,refund:B,screenview:k,set:L,time:j},Symbol.toStringTag,{value:"Module"})),Q=e=>{e.config.globalProperties.$gtag=K},$=e=>({send_page_view:!1,...e}),G=()=>{const{config:e,includes:n}=i();if(l("config",e.id,$(e.params)),Array.isArray(n))for(const t of n)l("config",t.id,$(t.params))},F=(e={},n={})=>{const{appName:t,pageTrackerTemplate:a,pageTrackerScreenviewEnabled:r,pageTrackerSkipSamePath:s}=i();if(s&&e.path===n.path)return;let c=e;if(g(a)?c=a(e,n):r&&(c=W({app_name:t,screen_name:e.name})),r){k(c);return}b(c)},U=e=>{const{pageTrackerExcludedRoutes:n}=i();return n.includes(e.path)||n.includes(e.name)},q=()=>{const{onBeforeTrack:e,onAfterTrack:n}=i(),t=y();t.isReady().then(()=>{d.nextTick().then(()=>{const{currentRoute:a}=t;G(),!U(a.value)&&F(a.value)}),t.afterEach((a,r)=>{d.nextTick().then(()=>{U(a)||(g(e)&&e(a,r),F(a,r),g(n)&&n(a,r))})})})},X=()=>{if(!f())return;const{enabled:e,globalObjectName:n,globalDataLayerName:t}=i();return window[n]==null&&(window[t]=window[t]||[],window[n]=(...a)=>{window[t].push(a)}),window[n]("js",new Date),e||h(),window[n]},C=()=>{const{onReady:e,onError:n,globalObjectName:t,globalDataLayerName:a,config:r,customResourceURL:s,customPreconnectOrigin:c,deferScriptLoad:Y,pageTrackerEnabled:Z,disableScriptLoad:x}=i(),ee=!!(Z&&y());if(X(),ee?q():G(),!x)return z(`${s}?id=${r.id}&l=${a}`,{preconnectOrigin:c,defer:Y}).then(()=>{e&&e(window[t])}).catch(V=>(n&&n(V),V))},I=(e,n,t)=>{Q(e),v(n),E(t),i().bootstrap&&C()};o.addRoutesTracker=q,o.bootstrap=C,o.config=p,o.customMap=M,o.default=I,o.event=u,o.exception=N,o.install=I,o.linker=R,o.optIn=S,o.optOut=h,o.pageview=b,o.purchase=D,o.query=l,o.refund=B,o.screenview=k,o.set=L,o.setOptions=v,o.setRouter=E,o.time=j,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
